---
import { IconChevronLeft, IconChevronRight } from "@tabler/icons-react";

const { images } = Astro.props;
---
<div id="gallery" class="hidden">
  <button
    id="left"
    class="fixed top-1/2 -translate-y-1/2 z-50 left-1 bg-white rounded-full p-4 cursor-pointer shadow-lg"
  >
    <IconChevronLeft />
  </button>
  <button
    id="right"
    class="fixed top-1/2 -translate-y-1/2 z-50 right-1 bg-white rounded-full p-4 cursor-pointer shadow-lg"
  >
    <IconChevronRight />
  </button>
  <div class="fixed bg-black/50 inset-0 z-40 backdrop-blur-sm" id="overlay">
    <div class="flex w-full items-center h-full snap-x snap-mandatory scroll-smooth overflow-x-auto" id="images">
      {images?.map((image, i) => (
        <img
          src={image.src}
          alt={image.alt}
          class="max-h-full max-w-full object-contain flex justify-center items-center h-full w-full shrink-0 p-4 snap-center"
        />
      ))}
    </div>
  </div>
</div>
<script>
  const gallery = document.getElementById("gallery");
  const images = document.getElementById("images");
  const left = document.getElementById("left");
  const right = document.getElementById("right");
  const overlay = document.getElementById("overlay");

  left.addEventListener("click", () => scrollLeft());
  right.addEventListener("click", () => scrollRight());
  overlay.addEventListener("click", () => close());

  function scrollLeft() {
    images.scrollLeft -= images.clientWidth;
  }

  function scrollRight() {
    images.scrollLeft += images.clientWidth;
  }

  function close() {
    gallery.classList.add("hidden");
  }

  document.onkeydown = function(evt) {
    evt = evt || window.event;
    var isEscape = false;
    if ("key" in evt) {
      isEscape = (evt.key === "Escape" || evt.key === "Esc");
    } else {
      isEscape = (evt.keyCode === 27);
    }
    if (isEscape) {
      close();
    }
  };
</script>
